<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Your AI - Cognis.ai</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
    <link rel="stylesheet" href="../Styles/style.css">
    <link rel="stylesheet" href="../Styles/create.css">
    <link rel="stylesheet" href="../Styles/animations.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <!-- Add auth.js for authentication check -->
    <script src="../js/auth.js"></script>
</head>
<body>
    <div id="particles-js"></div>
    <div class="neural-bg"></div>
    <div class="gradient-overlay"></div>
    
    <!-- Enhanced floating background elements -->
    <div class="floating-element floating-circle" style="top: 15%; left: 10%;" data-speed="20"></div>
    <div class="floating-element floating-circle" style="top: 65%; right: 12%;" data-speed="30"></div>
    <div class="floating-element floating-circle" style="top: 40%; left: 80%;" data-speed="25"></div>
    <div class="floating-element floating-circle" style="top: 75%; left: 25%;" data-speed="15"></div>

    <header>
        <nav>
            <a href="index.html" class="logo">Cognis.ai</a>
            <div class="nav-links animate__animated animate__fadeIn">
                <a href="characters.html"><i class="fas fa-robot"></i> Characters</a>
                <a href="create.html" class="active"><i class="fas fa-magic"></i> Create</a>
                <a href="about.html"><i class="fas fa-info-circle"></i> About</a>
                <a href="#" onclick="logout(); return false;" id="auth-link"><i class="fas fa-sign-out-alt"></i> Logout</a>
            </div>
        </nav>
    </header>

    <section class="create-character" id="create">
        <div class="create-header animate__animated animate__fadeInDown">
            <h2 class="gradient-text">Create Your AI Companion</h2>
            <p class="subtitle">Design a unique AI character tailored to your preferences and learning needs</p>
        </div>
        
        <div class="create-container">
            <div class="create-preview">
                <div class="preview-card">
                    <div class="preview-avatar">
                        <i class="fas fa-robot"></i>
                    </div>
                    <div class="preview-info">
                        <h3 id="previewName">Your AI Assistant</h3>
                        <p id="previewType">Personality Type: <span>Educational Mentor</span></p>
                        <div class="preview-expertise" id="previewExpertise">
                            <span class="expertise-tag"><i class="fas fa-calculator"></i> Mathematics</span>
                        </div>
                        <div class="preview-personality">
                            <div class="personality-meter">
                                <span>Friendly</span>
                                <div class="meter-bar">
                                    <div class="meter-fill" id="friendlyMeter" style="width: 50%"></div>
                                </div>
                            </div>
                            <div class="personality-meter">
                                <span>Professional</span>
                                <div class="meter-bar">
                                    <div class="meter-fill" id="professionalMeter" style="width: 50%"></div>
                                </div>
                            </div>
                            <div class="personality-meter">
                                <span>Creative</span>
                                <div class="meter-bar">
                                    <div class="meter-fill" id="creativeMeter" style="width: 50%"></div>
                                </div>
                            </div>
                        </div>
                        <p class="preview-description" id="previewDescription">Your AI assistant will help you learn and grow. Customize its personality and expertise to match your needs.</p>
                    </div>
                </div>
            </div>
            
            <div class="create-form glow">
                <form id="aiCreateForm" onsubmit="handleSubmit(event)">
                <div class="form-group">
                    <label for="aiName"><i class="fas fa-robot"></i> AI Name</label>
                    <input 
                        type="text" 
                        id="aiName" 
                        name="aiName" 
                        class="form-input" 
                        placeholder="Give your AI a name"
                        required
                        minlength="2"
                        maxlength="30"
                    >
                </div>

                <div class="form-group">
                    <label for="aiType"><i class="fas fa-brain"></i> AI Type</label>
                    <select id="aiType" name="aiType" class="form-input" required>
                        <option value="">Select AI Personality Type</option>
                        <option value="teacher">Educational Mentor</option>
                        <option value="creative">Creative Assistant</option>
                        <option value="professional">Professional Guide</option>
                        <option value="friend">Friendly Companion</option>
                        <option value="custom">Custom Personality</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="aiExpertise"><i class="fas fa-graduation-cap"></i> Areas of Expertise</label>
                    <div class="checkbox-group">
                        <label class="checkbox-label">
                            <input type="checkbox" name="expertise" value="math"> Mathematics
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="expertise" value="science"> Science
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="expertise" value="languages"> Languages
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="expertise" value="arts"> Arts
                        </label>
                    </div>
                </div>

                <div class="form-group">
                    <label for="aiPersonality"><i class="fas fa-magic"></i> Personality Traits</label>
                    <div class="personality-sliders">
                        <div class="slider-group">
                            <label>Friendly</label>
                            <input type="range" name="friendly" id="friendlySlider" min="1" max="10" value="5">
                            <div class="slider-value">5</div>
                        </div>
                        <div class="slider-group">
                            <label>Professional</label>
                            <input type="range" name="professional" id="professionalSlider" min="1" max="10" value="5">
                            <div class="slider-value">5</div>
                        </div>
                        <div class="slider-group">
                            <label>Creative</label>
                            <input type="range" name="creative" id="creativeSlider" min="1" max="10" value="5">
                            <div class="slider-value">5</div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label for="aiDescription"><i class="fas fa-pen"></i> Description</label>
                    <textarea 
                        id="aiDescription" 
                        name="aiDescription" 
                        class="form-input" 
                        placeholder="Describe your AI's personality, expertise, and how you'd like it to interact with you..."
                        required
                        minlength="50"
                        maxlength="500"
                    ></textarea>
                    <div class="char-count">0/500</div>
                </div>

                <button type="submit" class="btn btn-primary animate__animated animate__pulse animate__infinite">
                    <i class="fas fa-wand-sparkles"></i> Create Your AI Companion
                </button>
            </form>
        </div>
    </section>

    <script src="../js/particles-config.js"></script>
    <script src="../js/subjects.js"></script>
    <script>
        // Character count for description
        const description = document.getElementById('aiDescription');
        const charCount = document.querySelector('.char-count');
        
        description.addEventListener('input', function() {
            charCount.textContent = `${this.value.length}/500`;
            updatePreview();
        });

        // Live preview updates
        const nameInput = document.getElementById('aiName');
        const typeSelect = document.getElementById('aiType');
        const expertiseCheckboxes = document.querySelectorAll('input[name="expertise"]');
        const friendlySlider = document.getElementById('friendlySlider');
        const professionalSlider = document.getElementById('professionalSlider');
        const creativeSlider = document.getElementById('creativeSlider');
        
        // Preview elements
        const previewName = document.getElementById('previewName');
        const previewType = document.getElementById('previewType');
        const previewExpertise = document.getElementById('previewExpertise');
        const previewDescription = document.getElementById('previewDescription');
        const friendlyMeter = document.getElementById('friendlyMeter');
        const professionalMeter = document.getElementById('professionalMeter');
        const creativeMeter = document.getElementById('creativeMeter');
        
        // Update slider values
        const sliderValues = document.querySelectorAll('.slider-value');
        document.querySelectorAll('.slider-group input').forEach((slider, index) => {
            slider.addEventListener('input', function() {
                sliderValues[index].textContent = this.value;
                updatePreview();
            });
        });
        
        // Update preview function
        function updatePreview() {
            // Update name
            previewName.textContent = nameInput.value || 'Your AI Assistant';
            
            // Update type
            const selectedType = typeSelect.options[typeSelect.selectedIndex].text;
            previewType.innerHTML = `Personality Type: <span>${selectedType !== 'Select AI Personality Type' ? selectedType : 'Educational Mentor'}</span>`;
            
            // Update expertise
            previewExpertise.innerHTML = '';
            let hasExpertise = false;
            
            expertiseCheckboxes.forEach(checkbox => {
                if (checkbox.checked) {
                    hasExpertise = true;
                    const icon = checkbox.value === 'math' ? 'calculator' : 
                                checkbox.value === 'science' ? 'flask' : 
                                checkbox.value === 'languages' ? 'language' : 'palette';
                    
                    const tag = document.createElement('span');
                    tag.className = 'expertise-tag';
                    tag.innerHTML = `<i class="fas fa-${icon}"></i> ${checkbox.parentNode.textContent.trim()}`;
                    previewExpertise.appendChild(tag);
                }
            });
            
            if (!hasExpertise) {
                const tag = document.createElement('span');
                tag.className = 'expertise-tag';
                tag.innerHTML = '<i class="fas fa-calculator"></i> Mathematics';
                previewExpertise.appendChild(tag);
            }
            
            // Update personality meters
            friendlyMeter.style.width = `${friendlySlider.value * 10}%`;
            professionalMeter.style.width = `${professionalSlider.value * 10}%`;
            creativeMeter.style.width = `${creativeSlider.value * 10}%`;
            
            // Update description
            if (description.value) {
                previewDescription.textContent = description.value;
            } else {
                previewDescription.textContent = 'Your AI assistant will help you learn and grow. Customize its personality and expertise to match your needs.';
            }
        }
        
        // Add event listeners for all form elements
        nameInput.addEventListener('input', updatePreview);
        typeSelect.addEventListener('change', updatePreview);
        expertiseCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', updatePreview);
        });

        // Form submission handler
        function handleSubmit(event) {
            event.preventDefault();
            
            // Get form data
            const formData = new FormData(event.target);
            const data = {
                name: formData.get('aiName'),
                type: formData.get('aiType'),
                expertise: Array.from(formData.getAll('expertise')),
                personality: {
                    friendly: formData.get('friendly'),
                    professional: formData.get('professional'),
                    creative: formData.get('creative')
                },
                description: formData.get('aiDescription'),
                // Add a default image based on type
                image: '../Images/image' + (Math.floor(Math.random() * 3) + 2) + '.png'
            };

            // Show loading state
            const submitButton = event.target.querySelector('button[type="submit"]');
            const originalText = submitButton.innerHTML;
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Creating...';
            submitButton.disabled = true;

            // Save the subject to localStorage
            const savedSubject = saveSubject(data);
            console.log('AI Character Created:', savedSubject);
            
            // Simulate API call (replace with actual API call)
            setTimeout(() => {
                // Show success message
                alert('AI Character created successfully!');
                
                // Reset form
                event.target.reset();
                charCount.textContent = '0/500';
                
                // Reset button
                submitButton.innerHTML = originalText;
                submitButton.disabled = false;
                
                // Reset preview
                updatePreview();
                
                // Redirect to characters page to see the new character
                window.location.href = 'characters.html';
            }, 1500);
        }
        
        // Initialize preview on page load
        document.addEventListener('DOMContentLoaded', updatePreview);
        
        // Add parallax effect to floating elements
        document.addEventListener('mousemove', (e) => {
            const floating = document.querySelectorAll('.floating-element');
            const mouseX = e.clientX / window.innerWidth;
            const mouseY = e.clientY / window.innerHeight;

            floating.forEach(element => {
                const speed = element.getAttribute('data-speed') || 30;
                const x = (window.innerWidth - (mouseX * speed));
                const y = (window.innerHeight - (mouseY * speed));
                element.style.transform = `translate(${-x/50}px, ${-y/50}px)`;
            });
        });
    </script>
</body>
</html>